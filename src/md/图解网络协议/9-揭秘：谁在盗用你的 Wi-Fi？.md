还记得我们之前在第七节：[《穿越时空，探寻网络世界的演化历程！》](https://juejin.cn/book/7209116225988165667/section/7214846119883309108 "https://juejin.cn/book/7209116225988165667/section/7214846119883309108")说到物理层传输数据的媒体是多样的。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/83990eb383314af09865db9ef8a41b39~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1211&h=511&s=222084&e=png&b=f4f6f8) 现在移动互联网已经无处不在，它的覆盖范围比我们的思维还要广阔。当我们的有线网络不够用时，我们可以随时随地使用蜂窝网络和 Wi-Fi，它们就像是一条无形的线，把我们和整个世界联系在了一起。在日常生活中，如果没有蜂窝网络和 Wi-Fi，我们就会感到像失去了一条重要的神经，所有的事情都会变得十分困难。尤其是 Wi-Fi，它让我们的工作和娱乐都可以一路畅通无阻。

但是，你是否曾经遇到过这样的情况：在使用 Wi-Fi 的过程中，突然间卡顿不止，让你非常焦虑。别着急，这不一定是因为带宽不够，而有可能是因为有一些奇怪的东西在“偷”你的 Wi-Fi！

本文从一个真实事件引出，放松放松，先听听我的故事！

哎呀，办公网 Wi-Fi 怎么这么慢!
-------------------

事情是这样：当时在公司办公时，电脑上的浏览器就打不开了，一直卡在转菊花中。这令人非常烦恼，因此我使用 `ping` 对几个常用网站进行了测量；发现不是延迟高就是丢包。我猜想并不是 Wi-Fi 的问题，因为平时它的速度都很好。于是测试电脑的 Wi-Fi 状态，我发现 Wi-Fi `信号强度良好`，但`噪声很大`，如下图所示。

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d255abbdfa2044b891148fd8fef6c26c~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=390&h=512&s=57993&e=png&b=7b797d)

图中`RSSI` 的全称为 Received Signal Strength Indicator（接收信号强度指示器），此时的值为 -51dBm，处于正常范围（-50dBm 到 -90dBm）内。而`噪声值`为 -98dBm，超出正常范围（-85dBm 到 -95dBm），可见当前环境噪声对我的浏览器有影响。

Wi-Fi 信道是指`无线局域网（WLAN）`中的通信频段，用于在无线网络中传输数据。在 2.4 GHz 和 5 GHz 的无线频谱中，每个`频带`都可以被划分成多个不同的信道，以提供更多的无线网络连接。在使用 Wi-Fi 时，可以选择不同的信道，以避免与其他无线网络发生干扰，并提高信号质量和网络速度。但是，由于信道之间相互干扰，这就是噪声。需要合理选择信道以提高 Wi-Fi 网络性能。

当时我的 Mac 电脑的 Wi-Fi 频道处于 5.2G 频段的 56，`TX 速率`（发包速率）能达到 288Mbps，速度应该是不慢的。

一般认为，Wi-Fi 噪声是由于多个 Wi-Fi 信号之间的干扰而产生的。这些噪声会干扰 Wi-Fi 信号的传输，从而影响 Wi-Fi 的性能。并且由于 2.4G 频率的电波是开放的，很多标准的设备都直接使用，比如 USB，从而导致网速受到影响。因此，我们此前就升级了 Wi-Fi，从传统的 2.4G 升级到了 5G。

所以，我通过`手机魔盒`测试了附近的 Wi-Fi，发现当前环境的其他 Wi-Fi 也都不在一个频道，不会产生干扰。另外，也不是 2.4G 频道的 USB 或电磁炉影响了我的浏览器。

### 竟是 Airdrop 传照片的锅

当我百思不得其解时，我观察了一下四周，发现秘书桌面特别活跃，有几个美女也围在那里看照片。这让我突然明白：原来是因为秘书正在使用`Airdrop`将团建活动拍摄的一批照片从手机传送到电脑端，占用了 Wi-Fi 信道，导致我们的网速受到影响。当`Airdrop`传输完毕后，我的网速确实恢复正常了，其他同事也是如此！因此，我的猜想可能是正确的。

当遇到 Wi-Fi 卡顿时，可以去喝杯咖啡、聊天、看看书来放松一下，或者有紧急工作需要处理的时候不妨移步稍微远一点的会议室，就不会受到干扰了！

说到这里，你可能想知道为什么`Airdrop`会对 Wi-Fi 产生如此大的干扰。苹果的 Airdrop，以及无线投屏功能等，都是使用 Apple Wireless Direct Link 技术实现的。这项技术使用了一种特殊的无线传输模式，可以在无线网络中传输大量数据，从而对 Wi-Fi 产生干扰。

揭秘：AWDL 如何偷取 Wi-Fi 信号
---------------------

`Apple Wireless Direct Link（AWDL）`是苹果公司推出的独家无线直接链接协议，可实现点到点的高速数据传输。它使用 `802.11a/b/g/n/ac` 标准，最高速度可达 766Mbps，可以在两台设备之间建立直接连接，无需路由器和其他网络设备的支持。AWDL 可用于 Airdrop、Airplay、Gamekit 等功能，也可以创建局域网，在无线网络之间共享文件。

这里提到苹果使用了 802.11a/b/g/n/ac 标准，这个新名词如果让你觉得迷惑，可以点下面的“深入理解 802.11”理解一下；如果你对这块已经比较了解了，就建议跳过。

### 深入了解 802.11

IEEE 802.11 包括一系列标准，如下表所示：

802.11标准

频段

最大传输速率

802.11a

5GHz

54Mbps

802.11b

2.4GHz

11Mbps

802.11g

2.4GHz

54Mbps

802.11n

2.4GHz/5GHz

300Mbps

802.11ac

5GHz

1.3Gbps

*   802.11a 标准是 IEEE 802.11 系列中的一种，它使用 5GHz 频段，能够提供最大 54Mbps 的传输速率。有 8 个频道可供使用。
    
*   802.11b 标准也是 IEEE 802.11 系列中的一种，它使用 2.4GHz 频段，能够提供最大 11Mbps 的传输速率。它的传播距离比 802.11a 要短，但是 2.4GHz 的波段在室内环境传播时衰减较少，所以它是最受欢迎的无线标准之一。
    
*   802.11g 标准也是 IEEE 802.11 系列中的一种，它使用 2.4GHz 频段，能够提供最大 54Mbps 的传输速率。有 14 个频道可供使用，具有 802.11a 标准相同的传输速度和频道数量，但是这些频道可以在更短的距离内传播，因为它使用的是 2.4GHz 频段，这也使得它成为最受欢迎的无线标准之一。
    
*   802.11n 标准也是 IEEE 802.11 系列中的一种，它使用 2.4GHz 和 5GHz 频段，能够提供最大 300Mbps 的传输速率。
    
*   802.11ac 标准也是 IEEE 802.11 系列中的一种，它使用 5GHz 频段，能够提供最大 1.3Gbps 的传输速率。它采用 MIMO 作为多址调制方式，有 8 个频道可供使用。它不仅具有 802.11a/b/g/n 标准相同的信号覆盖距离和数据传输速度，还具有能够将信号分割成多个流的多址技术，从而能够有效提高无线网络的传输速度，所以它是最受欢迎的无线标准之一。
    

> 注意：5G 蜂窝和这说的 5GHz 频段不是一个概念，5G 蜂窝网络是由基站（Base Station）和用户设备（UE）组成的网络，它使用 5G NR（New Radio）技术，在频谱上使用新的频段和新的技术，以提高数据传输速率。

从前面的图可以看到，我们公司也刚好使用的 **802.11ac 标准。**

这些标准的主要区别在于使用的频道和传输速率。2.4GHz 频段的 Wi-Fi 可以覆盖更大的范围，但是传输速率比 5GHz 频段要低，而 5GHz 频段可以传输更快的数据，但是覆盖距离较短。

现在拉回正题，让我们来了解 AWDL 是如何偷取 Wi-Fi 信号的？为此，我们必须了解它的数据传输原理。

### 研究 Apple Wireless Direct Link (AWDL) 数据传输机制，揭开神秘面纱

`AWDL`（Apple Wireless Direct Link）是一种无线技术，可以使用 802.11a/b/g/n/ac 标准在两台 Apple 设备之间建立直接连接，无需路由器和其他网络设备的支持。它的数据传输原理是：`先利用蓝牙激活周围所有 Apple 设备的 AWDL 接口，然后通过两台设备的无线设备建立私有 Wi-Fi 进行点到点的数据传输`。

为了验证 `AWDL 的数据传输机制`，我使用了我的 iPhone 和 Mac 笔记本电脑之间的 Airdrop 功能。首先通过系统设置的地方确保打开了隔空投送的功能，如下图所示。

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21fbfe97fb5a46038ef591983cd6805e~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=602&h=238&s=52645&e=png&b=1c2b40)

经过几个小实验，我发现 AWDL 的数据传输机制确实可以有效地实现点到点的数据传输，但是`会影响到周围环境的 Wi-Fi`。

#### 实验 1：蓝牙没打开

在`不开启蓝牙`时双方的 `AirDrop` 功能没法相互识别，只有在打开了蓝牙之后，`Apple 设备`的 AWDL 接口才被激活。只有打开了蓝牙才允许隔空投送，否则会提示蓝牙已关闭，如下图所示。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e873f0785b14288a390c54643aecda3~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1125&h=1254&s=117124&e=jpg&b=f0efef)

`蓝牙设备`使用无线电波（而非电线或电缆）连接手机和电脑。当蓝牙设备之间想要相互交流时，它们需要进行`配对`，当网络环境创建成功，一台设备作为主设备，而所有其他设备作为从设备。

`蓝牙传输数据速度慢`，最多也不超过 70K/S。通过数据线直连的 USB 方式传输速度是最快的，传输一个 1.5GB 的文件，在 USB3.0 模式下耗时近 2.43 分钟，同等情况下 USB2.0 耗时 6.55 分钟，而 Wi-Fi 传输仅需 9.27 分钟完成，但是蓝牙 4.0 整个耗时长达 123.67 分钟，足足超过了 2 个小时。

所以，`AWDL`虽然利用蓝牙发现、激活设备，但是不会使用蓝牙传输数据，而是会`再组建一个直连的局域网`来传输数据。

#### 实验 2：局域网组建存在障碍

在通过蓝牙建立关联之后，当我把 `iPhone 的 Wi-Fi 和数据流量功能`都关闭的时候，再用 `iPhone 的 Airdrop 传图片`的时候，会提示下面的错误。

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31d59ade5cf548c987952a66e7360ae8~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1125&h=751&s=500841&e=jpg&b=f2f1f0)

因为这时候，发送方的 `iPhone 的 Wi-Fi 和数据流量功能`都关闭，意味着`无线局域网被关闭`，发送和接收的功能都被关闭，局域网组建存在障碍。

另一方面，让发送方的无线局域网功能打开（`iPhone 的 Wi-Fi 或数据流量开关打开`），但是当我把`接收方Mac电脑` 的 `Wi-Fi 功能关闭`的时候，也出现了`“未找到联系人”`的异常。如下所示：

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/018813128f8845d8b0b34079b833bdea~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=606&h=154&s=41170&e=png&b=5d7079)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a8246861c754e88aaf054a2275cc7c3~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1125&h=1251&s=685385&e=jpg&b=f3f1ef) `接收方Mac电脑` 的无线局域网功能只包括 `Wi-Fi 功能`，而没有`数据流量`。所以`Wi-Fi 功能关闭`的时候，就意味着无线功能完全被关闭。

`AWDL` 的要求其实不高，只要这两台设备`有蓝牙`，并且能够`打开无线功能`，能`组建局域网`就可以传输了。

避免我们进入一个误区的认识，这里要强调`AWDL`的功能`和这些设备本身是否联网无关`。

#### 实验 3：局域网组建成功

所以我打开这两台设备的局域网功能，两者就可以`通过 Airdrop 传输数据`了。但是当我在传送大量的数据的时候，则会出现下面这样的场景，会影响到的 Wi-Fi 环境。

当前传输的图片抓到的包用`Wireshark的统计功能`展示如下，可以看到速度确实非常快，`速度将近2.4Gbps`。

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a494db0b559d43888b5d9939988d3560~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1076&h=546&s=27969&e=png&b=ffffff)

同时我在这台电脑上面 `ping`一个网址`baidu.com`，明显出现了卡顿(之前`RTT是40ms左右`，而现在达到了`200～300ms`)。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/541015cd702c4a29b0abb78c357b5f18~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=1198&h=744&s=841384&e=png&b=030303)

在这种情况下，苹果再次展现其霸气。为了确保传输速度，他们设计了 `AWDL` 协议，可以同时占用 4 个 5G 信道进行高速传输（如下图所示）。因此，这 4 个信道会变得非常拥挤，导致网速减缓（卡卡的）。如果你的终端也在这 4 个信道中运行，那么你的网速肯定会受到影响。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68354c2e34834a7284c5c9495307a527~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=2525&h=753&s=592842&e=png&b=fefefe)

`Apple` 为个人用户设计的这些功能，在家庭环境中使用很方便。但在无线高密、高并发的办公场景内使用，将会对其他用户的无线体验带来灾难性的影响。

#### AWDL 技术小结

总的来说，`AWDL` 是一种局域网技术，它可以在设备之间建立一个点到点的`私有的` Wi-Fi 网络，使它们能够互相传输数据。因此，发送端必须开启局域网来实现这一功能。接收端也必须开启局域网，才能与发送端创建一个私有的 Wi-Fi 网络，实现数据传输。但是，传输数据的时候`占用 Wi-Fi 的信道`，可能会影响到其他人上网。

分享经验，收获成长
---------

如果你也有实验环境，建议也可以按照我的方法亲自看看苹果设备的无线投屏是否会对你的无线体验带来灾难性的影响。

在我们日常使用各种电器设备和联网设备的情况下，也还有很多原因会影响到我们的联网设备。

有人说在使用`微波炉`的过程中，感觉自己网速变卡了。那么，微波炉是否会影响到我们上网呢？

一般来说，微波炉使用不会影响到你上网，但如果你的电脑和微波炉离得太近，微波炉可能会影响到电脑的正常工作，从而影响到你上网的速度。所以，如果你的电脑和微波炉离得太近，建议你把它们放得更远一些，以免影响到你的上网速度。这简直不可思议！微波炉警告：电脑不要离太近喔！

哈哈，你还有什么场景感觉到你的 Wi-Fi 被“盗用”了呢？可以留言分享哦～