什么是计算机网络呢？有人说：计算机网络就是百度！还有人说：计算机网络就是 HTTP！如果你也是这么想的，那么希望本篇你能仔细看下去。

那么，计算机网络到底是什么呢？

> 客观地说，计算机网络就是：一些相互连接的、自治的计算机的集合。

说人话就是：**全世界所有通过互联网互相连接的计算机所组成的一个大网**。

如果你的电脑联网了，那就是计算机网络的一部分，如果你的电脑没联网，那就不是计算机网络的一部分。

计算机网络简介
-------

计算机网络可以分为：广域网、城域网、局域网和个人区域网。

*   广域网：覆盖几十到几千公里，比如我们日常说的上网，用百度、谷歌等，用的就是广域网。
*   城域网：一般覆盖一个城市，大约 5 到 50 公里，比如有的城市的宽带。
*   局域网：一般覆盖一公里左右，比如一个公司的内网。
*   个人区域网：覆盖范围只有几米，比如自己给自己开热点。

有人说，这些我都不在乎，我就在乎它快不快、猛不猛、看视频卡不卡，这就要提到网络的质量参数了。

判断一个网络的质量有 7 个性能指标。

*   速率：这个很好理解，就是传输速度。直接受到材料的影响，比如，相同条件下有线网肯定比无线网快；而同是有线网络，光纤就比电缆快。
    
*   带宽：可以简单理解为传输的横切面大小。我们把计算机网络的传输看作是一个水管，速率就是传输的速度，带宽就是水管横切面大小，越大传输得肯定越快。
    
*   吞吐量：单位时间内通过网络的数据量。这才是真正的传输速度，如果水管生锈了，那么速率是 100，也达不到 100，因为水锈会阻碍一部分传输，而吞吐量就是把所有因素都考虑进去之后，得出的最终的传输速度。
    
*   时延：把数据从 A 端发送到 B 端所需要的时间。
    
*   时延带宽积：发送数据时的延迟 x 带宽得出的结果。
    
*   往返时间：从 A 发数据到 B，到 A 收到 B 的响应所需要的时间。
    
*   利用率：网络在传输时信道的利用百分比。
    

> 我们把传输信号的介质统一称为：信道。

我们知道，网络传输的其实就是信号，或者说是电磁波，电磁波可以直接在空气中传播，可以在电缆中传播，也可以在光纤中传播。所以，空气、电缆、光纤等，都是信道。

我们传输的数据，也就是电磁波，从微观看就是一个一个的电子，电子在金属中的传输速度大于在空气中的传输速度，并且空气中有其他信号干扰，所以有线网就比 Wi-Fi 快。

那么，这些电子就这样传送，我咋知道它传送的什么玩意儿呢？

只要我们制定一个规则，然后大家都按照这个规则来传递，不就都明白了吗？

这个规则就叫做：**计算机网络协议**。

计算机网络协议
-------

> 计算机网络协议是指：为计算机网络中进行数据交换而建立的规则、标准或约定的集合。

比如，我们前面说过的 HTTP，也是计算机网络协议中的一部分，属于应用层协议。

应用层？还分层吗？

分，就像我们的代码也分内核层、Native 层、Framework 层、应用层一样，网络协议也是分层的。

分层就是为了简便，各司其职，分工明确，容易维护。

我们一般把网络协议分为 5 层：**物理层、数据链路层、网络层、传输层、应用层**。当然，也有其他分法，我们这里就不叨叨了。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cd1044869624526b251c272843327f1~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=260&h=290&s=10843&e=png&b=fff0c5)

这里要理清一个流程，比如 A 向 B 发数据，数据是从 A 的应用层开始，沿着传输层、网络层、链路层、物理层向下，再依次到达 B 的物理层、链路层、网络层、传输层，最后到达 B 的应用层。

就像 A 给 B 送信，A 住在 5 楼，B 住在对面的 5 楼，A 先要下到 1 楼，然后再从 B 住的楼上去，才能送达。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d00f22c8dd74eff95764bd65a4cd4ff~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.image#?w=666&h=388&s=24555&e=png&b=fcfcfc)

### 物理层

> 物理层规定传输媒介的一些特性。

比如说，我们上面说到的电缆和光纤都是传输媒介，当然还有其他的，比如无线信道、同轴电缆等。物理层指的不是这些实实在在的物理上的传输媒介，而是规定它们的协议。那么，这些传输媒介有什么共同点呢？可以分为四个点。

*   机械特性：指明接线器的形状和尺寸、引脚数目、排列方式等。
*   电气特性：指明每条线上的电压范围。
*   功能特性：指明每条线上每一个电平表示的意义。
*   过程特性：指明各种事件的出现顺序。比如，哪根信号线先动，哪根信号线先出现什么电平等。

换句话说，**物理层协议将具体的实实在在的传输媒介进行了高度总结，抽象成了四个特点，只要满足这四个特点，就可以作为传输媒介**。这样一来，我们不必去死记硬背到底哪些属于传输媒介，而只需要理解这四个特性，只要满足这四个特性的，就可以作为传输媒介。这就是**化记忆为理解的手段之一：找共性并总结抽象**。

这跟**面向对象中的将具体事物提炼成抽象类**有异曲同工之妙。

一般来说，我们的信道有三种。

*   单向通信：也叫单工通信，只能从一端到另一端通信，而不能反过来。比如我们收听的收音机广播。
*   双向交替通信：也叫半双工通信，双端都可以收发，但不能同时进行。
*   双向同时通信：也叫全双工通信，双方可以同时发送和接收。

现在，我们有了物理层，可以传输电子信号了，那么电子信号是怎么被识别成数据呢？又怎么保证可靠地到达另一端呢？

### 数据链路层

> 数据链路层负责将数据透明地、无差错地进行传输。

我们知道，传输媒介传输的是信号，或者说就是电子，那这怎么可能看得懂呢？很简单，我们传输的电子都会通过电路展示为**高低电平**，我们用高电平表示 1，低电平表示 0，这样就被翻译成了一串串二进制，而**数据链路层就负责把这些二进制封装成帧**，你可以将帧理解为一串二进制。

那么，在数据链路层我们的传输单位就从电子信号变成了帧。那么，要怎么保证这些帧正常地到达呢？这就是数据链路层的核心作用了。

首先，链路层会把我们的数据封装成一个一个的数据帧，说白了就是在数据前后添加标记，我们称之为**首部**和**尾部**，这样，当接收端收到数据后，就能首部和尾部的标记，来识别数据的开头和结束。

当然，我们传输数据的时候，不会感知到首部和尾部的存在，这是链路层自己添加的，在发送的时候自己添加，在接受的时候自己删除，这对我们来说是**透明的**。

其次，链路层会对发送的数据进行**差错检测**，比如最常见的循环冗余检测，如果遇到错误的数据帧，就会丢掉并重传，以此来提供可靠的、无差错的数据传输。

所以，链路层的功能就是：将数据封装成帧，进行透明地、无差错地传递。

那么，我们怎么知道要传输到哪里呢？数据怎么知道对方的地址呢？

### 网络层

> 网络层负责编址、寻址和转发。

网络层的核心功能就是寻址，也就是寻找地址。

我们知道，我们发送数据都需要一个 IP 地址。IP 就是一个协议，全称叫做 Internet Protoco，叫做国际互联协议，它可以表示一个地址，比如常见的 192.168.xxx.xx，叫做 IP 地址。

那么，这样的地址怎么能找到对方的主机呢？

我们可以通过**地址映射协议，也叫做 ARP（Address Resolution Protocol）** 来根据 IP 地址找到对应的主机地址，从而将数据塞给这个主机，或者从这个主机上拿数据。

主机地址是不变的，IP 地址是随着网络变化的。

比如：我的主机叫大灰狼，我连了我家的 wifi123，那么，我连了网，就会自动给我的主机分配一个 IP 地址，假如地址是 192.168.1.1，那么，隔壁喜羊羊就可以顺着这个地址来找到我的主机大灰狼，从而给我发消息；如果我换了另一个网络，我的主机又被重新分配一个新 IP 地址，那么，喜羊羊用老的 IP 地址就找不到我了。

这也就是我们连接不同的网络时，执行`ipconfig`查看到的 IP 地址不同的原因。

IP 地址有了，我们可以买个域名，比如 `https://www.yyds.nb`，然后将这个域名绑定到自己的 IP 地址，那么别人访问这个域名的时，就会访问到你的 IP 地址，这个过程叫做**域名映射**，跟上面的**地址映射**是异曲同工的。

所以，网络层的两个核心协议就是 IP 和 ARP，IP 协议负责给不同的主机分配 IP 地址，ARP 协议负责根据 IP 地址找到实际的主机地址。

那么，地址知道了，我们怎么传输数据呢？直接硬塞吗？非也！

### 传输层

> 传输层的核心作用就是进行数据的传输。

上面说到，我们通过网络层拿到了具体的主机地址，那么，数据传给谁呢？直接塞到系统的 C 盘吗？

肯定不会，应该是传给这个主机中的一个进程，这个进程收到数据后就进行数据的解析处理。那么，数据是怎么被进程获取到呢？

通过**端口号**！

每个主机上都有不同的端口号，我们可以开启一个进程去监听这个端口，只要监听到这个端口有数据，我们就立刻处理，这样就拿到了数据。

也就是说，数据传输不仅仅需要 IP 地址，还需要有端口号，比如常见的`192.168.0.1:8080`，其中 8080 就是端口号。最常见的就是 Socket 了。

**数据传输有两种传输方式，一种是面向连接的，可靠的 TCP 协议；另一种就是无连接的，不可靠的 UDP 协议。**

*   TCP（Transmission Control Protocol）：面向连接的，可靠的。
*   UDP（User Datagram Protocol）：无连接的，不可靠的。

照这么说，UDP 不就没啥用了吗，不可靠要你干啥？

存在就是道理！

TCP 虽然可靠，但是每次通信都要先建立连接，完事之后还要断开连接，就像打电话一样。

> A：喂，能听到么？
> 
> B：嗯，可以，And you?
> 
> A：me too，好，现在我们开始吹。
> 
> 1 个小时之后要结束了。
> 
> A：今天就到这里吧。
> 
> B：好的，就到这里吧。
> 
> A：好的，挂了。
> 
> B：好的，我也挂了。

累不累？这个美其名曰**三次握手四次挥手**。因为提前都互相问了对方能听到吗，所以是可靠的。但是我们也看到了，太费劲！

如果是 UDP 呢？就是如下这样。

> A：大风车啊咿呀咿呀转，xxxxxxxx，收到回复！
> 
> B：嗯！

就这么简单，就跟发短信似的，但是可能 B 没收到，所以不可靠。

所以，我们可以总结一下：**TCP 需要连接，费事，但是可靠；UDP 不需要连接，省事，但是不可靠**。

关于 TCP 和 UDP 的更多知识我们下一章具体讲解。

### 应用层

> 应用层直接给用户提供傻瓜式的服务。

这一层最常见的就是 HTTP 了，也叫做超文本传输协议（Hyper Text Transfer Protocol），大部分都是用来传递 JSON，也可以传递 HTML 页面，所以叫做超文本。

HTTP 是基于 TCP 的，所以也是需要连接的。

一次完整的 HTTP 请求如下，比如我们请求`https://juejin.cn`。

1.  通过域名映射找到`https://juejin.cn`对应的 IP 地址。
2.  通过这个 IP 地址加上默认端口 80 进行 TCP 连接。
3.  发送数据请求。
4.  等待对方主机返回响应结果，也就是一个 HTML 页面。
5.  得到结果，放在浏览器里面进行渲染，我们就看到了具体的页面。
6.  关闭 TCP 连接。

关于 HTTP 就不做过多讲解，应用层还有很多其他协议，比如文件传输协议 FTP、电子邮件协议 SMTP。

> 凡是 P 结尾的，大部分都是协议或原则。

比如，单一职责原则 SRP、开放闭合原则 OCP 等。

总结
--

本章知识比较杂，且记忆性东西比较多，我们再来回顾一下。

*   物理层：概括并抽象出传输信道的特点。
*   链路层：将数据封装成帧，并进行校验，保证数据可靠传输。
*   网络层：进行地址分配和地址访问。
*   传输层：连接并进行数据传输。
*   应用层：提供给用户使用。

我们不必死记硬背，只要知道这些都是规则即可，规则就是用来遵守和理解的，不是用来死记硬背的。下一章，我们就来看计算机网络中设计的最出彩的、最需要理解的地方：TCP 的可靠传输的实现。